<!DOCTYPE html>
<html lang="en" ng-app="miniumWebConsole" id="ng-app" ng-controller="WebConsoleCtrl">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Minium - Web Console for rapid Minium development">
    <meta name="author" content="Minium Authors">
    <link rel="shortcut icon" href="assets/ico/favicon.png">

    <title>Minium - Web Console</title>

    <!-- Bootstrap core CSS ans extensions -->
    <link href="bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="fontello/css/fontello.css" rel="stylesheet">
    <link href="bootstrap-modal/css/bootstrap-modal-bs3patch.css" rel="stylesheet">
    <link href="bootstrap-modal/css/bootstrap-modal.css" rel="stylesheet">

    <!-- Minium custom CSS -->
    <link href="minium-webconsole.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="../../assets/js/html5shiv.js"></script>
      <script src="../../assets/js/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Minium</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Web Drivers <b class="caret"></b></a>
              <ul id="browsers" class="dropdown-menu">
                <li><a href="#webDriversDialog" data-toggle="modal"><span class="glyphicon glyphicon-empty" ></span> List...</a></li>
                <li role="presentation" class="divider"></li>
                <li role="presentation" class="dropdown-header">Launch</li>
                <li ng-repeat="type in webDriverTypes">
                  <a href="#newWebDriverDialog" data-toggle="modal" ng-click="$parent.newWebDriverDialog.model.type = type">
                    <span class="glyphicon {{type.glyphicon}}" ></span> {{type.shortDisplayName}} <span class="badge pull-right" ng-hide="countWebDriversByType(type.id) == 0">{{countWebDriversByType(type.id)}}</span>
                  </a>
                </li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Preferences <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="#editorPreferencesDialog" data-toggle="modal">Editor...</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="container container-editor">
      <div id="editor"></div>
    </div><!-- /.container -->

    <!-- Modal windows -->
    <div id="selectorGadgetDialog" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <form name="selectorGadgetForm" role="form" ng-submit="selectorGadgetDialog.accept()">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              <h4 class="modal-title">Pick elements with Selector Gadget</h4>
            </div>
            <div class="modal-body">
              <p>Pick elements with Selector Gadget to generate a CSS selector expression.</p>
              <div class="form-group">
                <label for="selectorGadgetWebDriver" class="control-label">Web Driver</label>
                <select id="selectorGadgetWebDriver" name="webDriver" class="form-control" ng-model="selectorGadgetDialog.model.webDriver" ng-change="selectorGadgetDialog.activate()">
                  <option ng-repeat="variable in webDriverVariables">{{variable.variableName}}</option>
                </select>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary">Accept</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    
    <div id="webDriversDialog" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 id="editorPreferencesLabel" class="modal-title">Web Drivers</h4>
          </div>
          <div class="modal-body">
            <p>The following table shows which browsers (and corresponding script variable) are available.</p>
            <form id="webDriversFilterForm" role="form">
              <div class="form-group">
                <label for="webDriversFilterBrowser" class="control-label">Filter by browser</label>
                <select id="webDriversFilterByBrowser" name="filterByBrowser" class="form-control" ng-model="webDriversBrowserFilter">
                  <option value="">All Browsers</option>
                  <option ng-repeat="type in webDriverTypes">{{type.displayName}}</option>
                </select>
              </div>
            </form> 
            <table class="table table-striped table-condensed">
              <tr>
                <th>Variable</th>
                <th>Type</th>
                <th>Actions</th>
              </tr>
              <tr class="{{{ valid: 'success', invalid: 'danger' }[variable.state]}}" ng-repeat="variable in webDriverVariables | filter:webDriversBrowserFilter">
                <td>{{variable.variableName}}</td>
                <td>{{variable.type}}</td>
                <td class="text-right">
                  <button class="btn btn-primary" href="#screenshotDialog" data-toggle="modal" ng-show="variable.state != 'invalid'">
                    <span class="glyphicon glyphicon-camera"></span>
                  </button>
                  <button type="button" class="btn btn-danger" ng-click="removeWebDriverVariable(variable.variableName)">
                    <span class="glyphicon fontello-cancel"></span>
                  </button>
                </td>
              </tr>
            </table>
          </div>
          <div class="modal-footer">
            <button class="btn btn-default" data-dismiss="modal">Close</button>
          </div>  
        </div>
      </div>
    </div>
    
    <div id="newWebDriverDialog" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <form name="newWebDriverForm" class="form-horizontal" role="form" ng-submit="newWebDriverForm.$valid && newWebDriverDialog.submit()" novalidate>
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              <h4 class="modal-title">New {{newWebDriverDialog.model.type.displayName}} Web Driver</h4>
            </div>
            <div class="modal-body">
              <div class="media">
                <div class="pull-left">
                  <span class="media-object glyphicon {{newWebDriverDialog.model.type.glyphicon}}"></span>
                </div>
                <div class="media-body">
                  <p>Create a new Web Driver by typing the desired variable name for script access.</p> 
                  <div class="form-group" ng-class="{ 'has-error' : newWebDriverForm.varName.$dirty && newWebDriverForm.varName.$invalid}">
                    <label for="newWebDriverVarName" class="col-lg-3 control-label">Variable</label>
                    <div class="col-lg-9">
                      <input id="newWebDriverVarName" name="varName" type="text" class="form-control" ng-model="newWebDriverDialog.model.varName" required ng-pattern="/^[a-zA-Z_$][0-9a-zA-Z_$]*$/">
                      <span class="help-block" ng-show="newWebDriverForm.varName.$dirty && newWebDriverForm.varName.$error.required">Required field.</span>
                      <span class="help-block" ng-show="newWebDriverForm.varName.$dirty && newWebDriverForm.varName.$error.pattern">Must be a valid javascript variable.</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="newWebDriverDialog.reset()">Close</button>
              <button type="submit" class="btn btn-primary" ng-disabled="newWebDriverForm.$invalid">Create</button>
            </div>
          </div>
        </form>
      </div>
    </div>
    
    <div id="editorPreferencesDialog" class="modal fade"tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <form name="editorPreferencesForm" role="form" ng-submit="editorPreferencesForm.$valid && editorPreferencesDialog.submit()" novalidate>
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              <h4 class="modal-title">Editor Preferences</h4>
            </div>
            <div class="modal-body">
              <div class="form-group" ng-class="{ 'has-error' : editorPreferencesForm.fontSize.$dirty && editorPreferencesForm.fontSize.$invalid}">
                <label for="editorFontSize">Font size</label>
                <div class="input-group">
                  <input id="editorFontSize" name="fontSize" ng-model="editorPreferencesDialog.model.fontSize" type="number" class="form-control" placeholder="Enter font size" min="8" max="48" required>
                  <span class="input-group-addon">px</span>
                </div>
                <span class="help-block" ng-show="editorPreferencesForm.fontSize.$dirty && editorPreferencesForm.fontSize.$error.required">Required field.</span>
              </div>
              <div class="form-group" ng-class="{ 'has-error' : editorPreferencesForm.theme.$dirty && editorPreferencesForm.theme.$invalid}">
                <label for="editorTheme">Theme</label>
                <select id="editorTheme" name="theme" ng-model="editorPreferencesDialog.model.theme" class="form-control" required>
                  <optgroup label="Bright">
                    <option value="ace/theme/chrome">Chrome</option>
                    <option value="ace/theme/clouds">Clouds</option>
                    <option value="ace/theme/crimson_editor">Crimson Editor</option>
                    <option value="ace/theme/dawn">Dawn</option>
                    <option value="ace/theme/dreamweaver">Dreamweaver</option>
                    <option value="ace/theme/eclipse">Eclipse</option>
                    <option value="ace/theme/github">GitHub</option>
                    <option value="ace/theme/solarized_light">Solarized Light</option>
                    <option value="ace/theme/textmate" selected="selected">TextMate</option>
                    <option value="ace/theme/tomorrow">Tomorrow</option>
                    <option value="ace/theme/xcode">XCode</option>
                  </optgroup>
                  <optgroup label="Dark">
                    <option value="ace/theme/ambiance">Ambiance</option>
                    <option value="ace/theme/chaos">Chaos</option>
                    <option value="ace/theme/clouds_midnight">Clouds Midnight</option>
                    <option value="ace/theme/cobalt">Cobalt</option>
                    <option value="ace/theme/idle_fingers">idleFingers</option>
                    <option value="ace/theme/kr_theme">krTheme</option>
                    <option value="ace/theme/merbivore">Merbivore</option>
                    <option value="ace/theme/merbivore_soft">Merbivore Soft</option>
                    <option value="ace/theme/mono_industrial">Mono Industrial</option>
                    <option value="ace/theme/monokai">Monokai</option>
                    <option value="ace/theme/pastel_on_dark">Pastel on dark</option>
                    <option value="ace/theme/solarized_dark">Solarized Dark</option>
                    <option value="ace/theme/terminal">Terminal</option>
                    <option value="ace/theme/tomorrow_night">Tomorrow Night</option>
                    <option value="ace/theme/tomorrow_night_blue">Tomorrow Night Blue</option>
                    <option value="ace/theme/tomorrow_night_bright">Tomorrow Night Bright</option>
                    <option value="ace/theme/tomorrow_night_eighties">Tomorrow Night 80s</option>
                    <option value="ace/theme/twilight">Twilight</option>    
                    <option value="ace/theme/vibrant_ink">Vibrant Ink</option>
                  </optgroup>
                </select>
                <span class="help-block" ng-show="editorPreferencesForm.theme.$dirty && editorPreferencesForm.theme.$error.required">Required field.</span>
              </div>
              <div class="form-group form-inline" ng-class="{ 'has-error' : editorPreferencesForm.tabSize.$dirty && editorPreferencesForm.tabSize.$invalid}">
                <label for="editorTabSize">Tab Size</label>
                <div class="input-group">
                  <input id="editorTabSize" name="tabSize" ng-model="editorPreferencesDialog.model.tabSize" type="number" class="form-control" placeholder="Enter tab size" min="1" max="8" required>
                  <span class="input-group-addon">
                    <input id="editorSoftTabs" name="softTabs" ng-model="editorPreferencesDialog.model.softTabs" type="checkbox" value="true"> Soft tabs
                  </span>
                </div>
                <span class="help-block" ng-show="editorPreferencesForm.tabSize.$dirty && editorPreferencesForm.tabSize.$error.required">Required field.</span>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="editorPreferencesDialog.reset()">Close</button>
              <button type="submit" class="btn btn-primary" ng-disabled="editorPreferencesForm.$invalid">Save changes</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div id="screenshotDialog" class="modal fade container" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <form id="screenshotForm" class="form-horizontal" role="form">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              <h4  class="modal-title">Screenshot</h4>
            </div>
            <div class="modal-body">
              <img src="data/screenshot1.png" class="img-responsive img-center" alt="Screenshot">
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary">Retake</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="assets/js/jquery.js"></script>
    <script src="jquery-cookie/jquery.cookie.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="bootstrap-modal/js/bootstrap-modalmanager.js"></script>
    <script src="bootstrap-modal/js/bootstrap-modal.js"></script>
    <script src="bootstrap-growl/jquery.bootstrap-growl.min.js"></script>
    <script src="ace/ace.js"></script>
    <script src="angularjs/angular.js"></script>
    <script src="angularjs/angular-resource.js"></script>
    <script src="angular-promise-tracker/promise-tracker.js"></script>

    <script src="app.js"></script>
    <script src="controllers.js"></script>

    <script type="text/javascript">
      // as described in https://github.com/jschr/bootstrap-modal
      $.fn.modal.defaults.spinner = $.fn.modalmanager.defaults.spinner = 
        '<div class="loading-spinner" style="width: 200px; margin-left: -100px;">' +
            '<div class="progress progress-striped active">' +
                '<div class="progress-bar" style="width: 100%;"></div>' +
            '</div>' +
        '</div>';

      console.debug("Removing .modal-dialog class because of https://github.com/jschr/bootstrap-modal/pull/164#issuecomment-24649686");
      $(".modal-dialog").removeClass("modal-dialog");

      console.debug("Addind .modal-body to .modal[data-remote] because of remote loading issue");
      $(".modal[data-remote]").append($("<div></div>", { class : "modal-body", style : "padding: 0" }));
      $(".modal[data-remote]").on("loaded", function() {
        $(this).find(".modal-dialog").removeClass("modal-dialog");
      });
    </script>
  </body>
</html>
